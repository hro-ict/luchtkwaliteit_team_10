<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
	<script src="https://code.jquery.com/jquery-3.7.0.js" integrity="sha256-JlqSTELeR4TLqP0OG9dxM7yDPqX1ox/HfgiSLBj8+kM=" crossorigin="anonymous"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script src=
  "https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js">
          </script>
          <script src=
  "https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js">
          </script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js"></script>



  <link href=
  'https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/ui-lightness/jquery-ui.css' 
            rel='stylesheet'>
      <style>
          .ui-datepicker {
              width: 100%; 
          }
          h1{
              color:green;
          }


          table {
  font-family: arial, sans-serif;
  border-collapse: collapse;
  width: 100%;
}

td, th {
  border: 1px solid #dddddd;
  text-align: left;
  padding: 8px;
}

thead {
  border: 1px solid red; 
}

tr:nth-child(even) {
  background-color: #dddddd;
}
      </style>
</head>
<body>
<div class="container mt-5 ">
  <form >
    <div class="row">
      
      <div class="col-12">
        <h6 class="text-center">KIES DE KOMENDE DAGEN</h6>
        <!-- <label class="text-center" for="end">kies de komende dagen</label> -->
        <input type="text"  class="form-control" id="end" required/>
      </div>
    </div>
    <button type="submit" id="get" class="btn btn-primary w-100 mt-5">GET</button>

  </form>


	<table class="mb-5">
		<!-- <thead>
		<tr>
		
			<td>
				Uur
			</td>
			<td>
				Status
			</td>
		</tr>
		</thead> -->

	</table>
</div>


<script>
$(function() {
    $("#end").datepicker({
      maxDate:'+5d',
        minDate: '+1',
        dateFormat: "yy-m-d"
    }
    );
    
});

let start=""
let end=""
$("form").submit(function(e){
  e.preventDefault()

  $("table").empty()
  const today = new Date()
  const tomorrow = new Date(today)
  tomorrow.setDate(tomorrow.getDate() + 1)

  var next_day = moment(tomorrow).format('YYYY-MM-DD');

  start= next_day
  end= $("#end").val()
  end= end.replace("/", "-").replace("/", "-")
  const server_data= {
    //max 5 days
    //year-month-day
    start_date: start,
    end_date: end
}
  
$.ajax({
  type: "POST",
  url: "http://143.47.183.218:3389/get_data",
  data: JSON.stringify(server_data),
  contentType: "application/json",
  dataType: 'json' ,
  success: function(data){
    //data 5 days predictions
    
   
    let counter=0
    if (data.error){
      $("table").empty()
      Swal.fire({
  // title: 'Error!',
  text: 'U mag maximaal 5 dagen kiezen',
  icon: 'error',

})
    }
    else {
      data.data.forEach(element => {
      counter+=1
      console.log(element.date)
      const d = new Date(element.date);
      const weekday = ["Zondag","Maandag","Dinsdag","Woensdag","Donderdag","Vrijdag","Zaterdag"];
      let day = weekday[d.getDay()];
       
      var format_date= element.date.split("-")
      var format_day= format_date[2]
      var format_month= format_date[1]
      var format_year= format_date[0]
      format_date= `${format_day}-${format_month}-${format_year}`
     

      const html= `<tr>
   
      <td>${element.hour} </td>
      <td>${element.state} </td>
      </tr>
      `

      if (element.hour=="0:00"){
       
        $("table").append(`<h3 class='text-center fw-bold mt-5 mb-3'>${format_date}- ${day}  </h3>`)
        // $("table").append(
        //   "<thead> <tr><td>UUR</td><td>STATUS</td></tr> </thead>"
        // )
      }
      $("table").append(html)
      
      
    });

    }
   
  },
  error: function(err){
    console.log(err)
  }
});


})


</script>

</body>
</html>
